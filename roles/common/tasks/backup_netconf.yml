---
- name: Collect running config via NETCONF
  ansible.netcommon.netconf_get:
    source: "{{ netconf_source }}"
    filter: "{{ netconf_filter | default(omit, true) }}"
  register: netconf_result

- name: Set raw config from NETCONF output
  ansible.builtin.set_fact:
    raw_config: >-
      {{
        (netconf_result.stdout | first)
        if (netconf_result.stdout is iterable and (netconf_result.stdout is not string))
        else (netconf_result.stdout | default(netconf_result.rpc_reply))
      }}
